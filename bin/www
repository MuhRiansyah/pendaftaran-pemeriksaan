#!/usr/bin/env node

var debug = require('debug')('express-example');
var app = require('../app');
var models = require("../models");



app.set('port', process.env.PORT || 8080);

models.sequelize.sync().then(function () {
  var server = app.listen(app.get('port'), function() {
    console.log('Express server listening on port ' + server.address().port);
  });
  var io = require('socket.io').listen(server);
  io.sockets.on('connection', function (socket) { // First connection
    socket.on('broadcast-suster', function (data) {
      socket.broadcast.emit('ubah-antrian-pemeriksaan', data);
    });
    socket.on('broadcast-antrian-pembayaran', function (data) {
      console.log(data);
      socket.broadcast.emit('ubah_antrian_pembayaran', data);
    });
    socket.on('pembayaranke-antrianpemeriksaan-kelolaantrian', function (data) {
      console.log(data);
      socket.broadcast.emit('ubah-antrian-pemeriksaan', data);
    });
  });

});
